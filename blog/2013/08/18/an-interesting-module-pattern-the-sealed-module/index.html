
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><script src="//cdnjs.cloudflare.com/ajax/libs/wysihtml5/0.3.0/wysihtml5.min.js"></script><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  
  
  

  <title>An Interesting Module Pattern: the Sealed Module - Brian Chu</title>

  
  <meta name="robots" content="noarchive">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <meta name="author" content="Brian Chu">
  
  <meta name="description" content="Sharing private state across components of a module in JavaScript.">
  

  <meta name="apple-mobile-web-app-title" content="Brian Chu">

  
  <meta property="og:title" content="An Interesting Module Pattern: the Sealed Module - Brian Chu">
  
   
  <meta property="og:description" content="Sharing private state across components of a module in JavaScript.">
  
  <meta property="fb:profile_id" content="brian.chu">
  <meta property="fb:app_id" content="210604952463349">
  <meta property="og:type" content="article">
  
  <meta property="article:published_time" content="2013-08-18 06:00:00 -0700">
  <meta property="article:section" content="Blog">
  
    <meta property="article:tag" content="javascript">
  
    <meta property="article:tag" content="tutorials">
  
  
  


  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="brrrianchu">

  

  

  <meta name="twitter:title" content="An Interesting Module Pattern: the Sealed Module">

  
  
  
  <meta name="twitter:description" content="An interesting way to share private state across components of modules in JavaScript: (credit goes to this article) var module = (function (module) { var _private = module._private = module._private &hellip;">
  
  


  
  <meta property="st:title" content="An Interesting Module Pattern: the Sealed Module - Brian Chu" >
    
      <meta property="st:published_at" content="2013-08-18T06:00:00-07:00">
    
  


  
  <link rel="canonical" href="http://www.brianchu.com/blog/2013/08/18/an-interesting-module-pattern-the-sealed-module/">
  <link href="/favicon.ico" rel="icon">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="apple-touch-icon-precomposed" href="apple-touch-icon.png">

<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,400italic' rel='stylesheet'>
<!--(if target dev)>Note: no such target, intentional<!-->
<link href='/stylesheets/bootstrap/bootstrap.css' rel='stylesheet'>
<link href='/stylesheets/fonts/font-awesome.css' rel='stylesheet'>
<!--<!(endif)-->
<!--(if target public)>
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<!(endif)-->

  <link href="/stylesheets/syntax/syntax.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/custom/custom.css" media="screen, projection" rel="stylesheet" type="text/css">

  <link href="/atom.xml" rel="alternate" title="I'm Brian Chu" type="application/atom+xml">
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-41298092-1', 'auto');
    ga('send', 'pageview');
  </script>


</head>

<body   >
<!--[if lt IE 9]>
  <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->
  <div class="fixed-top alert text-center" style="display:none">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  <strong></strong> <span></span>
</div>
  <div class="container">
    <header class="row" role="banner">
  <section class="col-md-4 profile-pic-container">
      <a href="/"><img src="/images/profile.png" title="Brian Chu" alt="Brian Chu" id="profile-pic"></a>
  </section>

  <section class="col-md-8" role="banner">
    <h1 class="title">I&#8217;m <span class="nowrap">Brian Chu</span><span class="title-subdue">,</span></h1>
  
    <span>
        <h3 class="inline"><span style="font-size:22%">&nbsp;</span>a software engineer.
    </span>
  
  </section>
</header>

    <div class="row content-row">
      
      
<aside class="col-md-4 side-bar clear-affix" data-spy="affix" data-offset-top="161"></aside>

<aside class="col-md-4 side-bar" data-spy="affix" data-offset-top="161">
  <div class="side-bar-responsive">
    
      <button class="menu-btn hide"><i class="fa fa-align-justify fa-lg"></i></button>
<section role="navigation" class="well side-item side-nav">
  <ul class="list-group">
    <li class="list-group-item"><a href="/" class="btn flat-btn icon icon-blog ">Blog</a></li>
    <li class="list-group-item"><a href="/about/" class="btn flat-btn icon icon-user ">About Me</a></li>
    <li class="list-group-item"><a href="/projects/" class="btn flat-btn icon icon-projects ">Projects</a></li>
    
    <li class="list-group-item" data-toggle="buttons-checkbox">
        <a class="btn flat-btn icon icon-contact" data-toggle="modal" data-target=".contact-modal">Contact Me</a>
    </li>
  </ul>
  <form class="nav-search">
    <a class="search-toggle"><i class="fa fa-search"></i></a>
    <div class="input-padding-wrapper"><input type="text" id="st-search-input" class="col-md-12 st-search-input search-query" placeholder="Search"></div>
    <a class="close-search force-hide">Close</a>
  </form>
</section>

<section class="well side-item side-email clearfix side-nonresponsive">
  <p>I write posts occasionally. Leave your email here and I&#8217;ll keep you updated!</p>

  <form action="http://brianchu.us7.list-manage1.com/subscribe/post?u=9711ca0ed3e46c42279302403&amp;id=7067371fb0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="subscribe-form" target="_blank" role="form">
  <div class="form-group">
    <input type="email" value="" name="EMAIL" class="form-control defer-invalid" id="mce-EMAIL" placeholder="Email" required>
   </div>
    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn flat-btn flat-small pull-right well-adjust clearfix">
  </form>
</section>

    
  </div>
</aside>



<section class="hentry col-md-8 block" role="article">

<article data-swiftype-index="true">

  <header class="page-header">
    
      
      <h2 class="entry-title">An Interesting Module Pattern: the Sealed Module</h2>
    
    
      <div class="meta">
        





<time class='entry-date' datetime='2013-08-18T06:00:00-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span></time>
        
      </div>
    
  </header>



<div class="article-body"><p>An interesting way to share private state across components of modules in JavaScript: <!-- more --><br/>
(credit goes to <a href="http://www.adequatelygood.com/JavaScript-Module-Pattern-In-Depth.html">this article</a>)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">module</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">module</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">_private</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_private</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_private</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">_seal</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">delete</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_private</span><span class="p">;</span>
</span><span class='line'>    <span class="k">delete</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span><span class="p">;</span>
</span><span class='line'>    <span class="k">delete</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_unseal</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">_unseal</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_unseal</span> <span class="o">=</span> <span class="nx">module</span><span class="p">.</span><span class="nx">_unseal</span> <span class="o">||</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">module</span><span class="p">.</span><span class="nx">_private</span> <span class="o">=</span> <span class="nx">_private</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span> <span class="o">=</span> <span class="nx">_seal</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">module</span><span class="p">.</span><span class="nx">_unseal</span> <span class="o">=</span> <span class="nx">_unseal</span><span class="p">;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="c1">// permanent access to _private, _seal, and _unseal</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">module</span><span class="p">;</span>
</span><span class='line'><span class="p">}(</span><span class="nx">module</span> <span class="o">||</span> <span class="p">{}));</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>_unseal</code> must be called by a function (probably some sort of loader function) that was initialized before <code>_seal</code> was called (so that <code>_unseal</code> will be present in its closure scope).</p>

<p>For example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">loadScript</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">scriptUrl</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">module</span><span class="p">.</span><span class="nx">_unseal</span><span class="p">();</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">scriptUrl</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s2">&quot;loaded&quot;</span> <span class="o">||</span>
</span><span class='line'>          <span class="nx">script</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="s2">&quot;complete&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">script</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>        <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">module</span><span class="p">.</span><span class="nx">_seal</span><span class="p">()</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">append</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>

</div>

</article>

  <footer>
    <div class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Brian Chu</span></span>
 on
      





<time class='entry-date' datetime='2013-08-18T06:00:00-07:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span></time>
      in
      

<span class="categories">
  
    <a class='category' href='/blog/categories/javascript/'>javascript</a>, <a class='category' href='/blog/categories/tutorials/'>tutorials</a>
  
</span>


    </div>
    <ul class="pager">
      
      <li class="next"><a class="basic-alignment right" href="/blog/2013/09/11/photo-embarrassment/"
        title="Next Post: Photo Embarrassment">Photo Embarrassment
        &raquo;</a></li>
      
      
      <li class="previous"><a class="basic-alignment left"
        href="/blog/2013/08/14/a-little-thing-with-versions/" title="Previous Post:
        A Little Note on Versions">&laquo; A Little Note on Versions</a></li>
      
      <li class="archives"><a href="/blog/archives">Blog Archives</a></li>
    </ul>

    


<div class="bottom-asides">

<section class="well side-item side-email side-responsive">
  <p>I write posts occasionally. Leave your email here and I&#8217;ll keep you updated!</p>

  <form action="http://brianchu.us7.list-manage1.com/subscribe/post?u=9711ca0ed3e46c42279302403&amp;id=7067371fb0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="subscribe-form" target="_blank" role="form">
  <div class="form-group">
    <input type="email" value="" name="EMAIL" class="form-control defer-invalid" id="mce-EMAIL" placeholder="Email" required>
   </div>
    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn flat-btn flat-small pull-right well-adjust clearfix">
  </form>
</section>

</div>



    
      
<div class="sharing" aria-live="polite">

  <a href="http://news.ycombinator.com/submit" class="hn-share-button" data-title="An Interesting Module Pattern: the Sealed Module">Vote on HN</a>

  
    <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.brianchu.com/blog/2013/08/18/an-interesting-module-pattern-the-sealed-module/" data-via="brrrianchu" data-counturl="http://www.brianchu.com/blog/2013/08/18/an-interesting-module-pattern-the-sealed-module/" >Tweet</a>
  

  

  
    <style>.fb-like span { vertical-align: top !important; }</style>
    <div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true" data-ref></div>
  

  
    <script src="//platform.linkedin.com/in.js">lang: en_US</script><script type="IN/Share" data-counter="right" data-showzero="false" async defer></script>
  

</div>

    
    
    <section>
      <h2>Comments</h2>
      <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
    </section>
    
  </footer>
</section>

    </div>

    <footer role="contentinfo" class="row content-row end-footer">
  <ul class="col-md-12 list-inline">
    
    <li><a href="https://github.com/bchu" title="Github"><i class="fa fa-lg fa-github-square"></i> bchu</a></li>
    <li><a href="https://twitter.com/brrrianchu" title="Twitter"><i class="fa fa-lg fa-twitter-square"/></i> @brrrianchu</a></li>
    <li><a href="http://www.linkedin.com/in/brchu" title="LinkedIn"><i class="fa fa-lg fa-linkedin-square"/></i></a></li>
    
    <li><a href="https://plus.google.com/115101039553139400331?rel=author" title="Google+"><i class="fa fa-lg fa-google-plus-square"/></i></a></li>
    
    <li><a href="/atom.xml" rel="subscribe-rss" title="Subscribe via RSS"><i class="fa fa-lg fa-rss"></i></a></li>
    <li><small><a href="/privacy">Privacy</a></small></li>
  </ul>
</footer>



    <div class="modal fade contact-modal" tabindex="-1" role="dialog" aria-labelledby="modalHeader" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="modalHeader">Contact Me</h3>
      </div>

      <iframe src="about:blank" id="contact-form-frame" name="contact-form-frame" style="display: none;"></iframe>
      <form action="" method="POST" target="contact-form-frame" role="form">

        <div class="modal-body">

          <div class="form-group">
            <label for="entry_562979872">Name:</label>
            <input class="form-control contact-name" type="text" name="entry.562979872" value="" id="entry_562979872" dir="auto">
          </div>

          <div class="form-group">
            <label for="entry_1424764388">Email (for my reply):</label>
            <input class="form-control defer-invalid" type="email" name="entry.1424764388" value="" id="entry_1424764388" dir="auto" placeholder="Required" aria-required="true" required>
          </div>

          <div class="form-group">
            <label for="entry_1142668288">Message:</label>
            <textarea class="form-control defer-invalid" name="entry.1142668288" rows="5" cols="0" id="entry_1142668288" dir="auto" placeholder="Required" aria-required="true" required></textarea>
          </div>

          <div class="checkbox">
            <label class="contact-checkbox">
              <input type="checkbox" name="entry.497122630" value="Yes" id="group_497122630_1"> Sign up for my email newsletter?
            </label>
          </div>
          <input type="hidden" name="draftResponse" value="[]">
          <input type="hidden" name="pageHistory" value="0">

        </div><!-- /.modal-body -->

        <div class="modal-footer">
          <input type="submit" name="submit" value="Send" class="btn flat-btn flat-small well-adjust">
        </div>
      </form>

    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

  </div>
  

<script>
      var disqus_shortname = 'brianchu';
      
        
        
        var disqus_identifier = 'http://www.brianchu.com/blog/2013/08/18/an-interesting-module-pattern-the-sealed-module/';
        var disqus_url = 'http://www.brianchu.com/blog/2013/08/18/an-interesting-module-pattern-the-sealed-module/';
        var disqus_title = 'An Interesting Module Pattern: the Sealed Module'
        var disqus_script = 'embed.js';
      
</script>

  
    <script src="//brianchu.disqus.com/embed.js" async defer></script>
  




<script src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=210604952463349" async defer></script>
<div id="fb-root"></div>



<script src="//platform.twitter.com/widgets.js" async defer></script>



<div id="st-results-container"></div>
<script>
  var Swiftype = window.Swiftype || {};
  (function() {
    Swiftype.key = '5J3i1dwgBx7wrJPqyp31';
    Swiftype.inputElement = '#st-search-input';
    Swiftype.resultContainingElement = '#st-results-container';
    Swiftype.attachElement = '#st-search-input';
    Swiftype.renderStyle = 'overlay';
  }());
</script>
<script src="//swiftype.com/embed.js" async defer></script>




<!--(if target dev)><!-->
<script src="/javascripts/libs/jquery-2.1.3.js"></script>
<script src="/javascripts/libs/modernizr-2.8.3.js"></script>
<script src="/javascripts/libs/bootstrap.js"></script>
<script src="/javascripts/libs/github-widgets.js"></script>
<script src="/javascripts/libs/hn.min.js"></script>
<script src="/javascripts/octopress.js"></script>
<script src="/javascripts/custom.js"></script>
<!--<!(endif)-->
<!--(if target public)>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="/javascripts/libs.js"></script>
<script src="/javascripts/custom.js"></script>
<!(endif)-->

<!--[if lte IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-placeholder/2.0.8/jquery.placeholder.min.js"></script>
<![endif]-->


</body>
</html>
